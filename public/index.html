<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Falling Images - Javzaa</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        min-height: 100vh;
        background: linear-gradient(
          135deg,
          #0a0015 0%,
          #1a0520 50%,
          #0f0820 100%
        );
        overflow: hidden;
        font-family: system-ui, -apple-system, sans-serif;
        position: relative;
      }

      .fireworks-canvas {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 1;
      }

      .container {
        position: fixed;
        inset: 0;
        overflow: hidden;
        transform-style: preserve-3d;
        perspective: 1000px;
        z-index: 2;
      }

      .falling-item {
        position: absolute;
        pointer-events: none;
        will-change: transform, opacity;
      }

      .falling-item img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 12px;
        /* box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6),
          0 0 30px rgba(255, 180, 240, 0.4),
          inset 0 0 20px rgba(255, 255, 255, 0.1);
        filter: brightness(1.1) contrast(1.05); */
        box-shadow: none;
        filter: none;
      }

      .falling-text {
        font-size: 28px;
        font-weight: 700;
        white-space: nowrap;
        text-shadow: 0 0 10px currentColor, 0 0 20px currentColor,
          0 0 30px rgba(255, 255, 255, 0.5);
        filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.6));
      }

      .color-1 {
        color: #ff6b9a;
      }
      .color-2 {
        color: #9be7ff;
      }
      .color-3 {
        color: #ffd6f0;
      }
      .color-4 {
        color: #d0ffb8;
      }
      .color-5 {
        color: #ffeb99;
      }

      .controls {
        position: fixed;
        top: 10px;
        right: 10px;
        background: rgba(0, 0, 0, 0.7);
        padding: 10px;
        border-radius: 12px;
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: #fff;
        max-width: 90%;
        width: 320px;
        z-index: 1000;
        transform: translateX(calc(100% - 40px));
        transition: transform 0.3s ease;
        font-size: 14px;
      }

      .controls {
        transform: translateX(-120%);
        opacity: 0;
        pointer-events: none;
        transition: transform 0.3s ease, opacity 0.3s ease;
      }

      .controls.visible {
        transform: translateX(0);
        opacity: 1;
        pointer-events: auto;
      }

      #toggleControls {
        background: linear-gradient(135deg, #ff6b9a, #ff3d7f);
        color: white;
        border: none;
        padding: 10px 12px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        box-shadow: 0 4px 15px rgba(255, 107, 154, 0.4);
        font-weight: 700;
      }

      #showControls {
        display: none;
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 110;
        background: linear-gradient(135deg, #ff6b9a, #ff3d7f);
        color: white;
        border: none;
        padding: 10px 12px;
        border-radius: 12px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
        cursor: pointer;
      }

      .controls.hidden + #showControls {
        display: block;
      }

      .controls,
      #showControls {
        transition: transform 0.28s ease, opacity 0.28s ease;
      }

      .controls h3 {
        margin: 0 0 12px 0;
        font-size: 16px;
        color: #ff6b9a;
        text-align: center;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      }

      .control-group {
        margin-bottom: 12px;
      }
      
      .control-group label {
        font-size: 12px;
        display: block;
        margin-bottom: 4px;
      }

      .control-group label {
        display: block;
        margin-bottom: 5px;
        font-size: 13px;
        color: #ccc;
      }

      .control-group input[type="text"] {
        width: 100%;
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 8px;
        color: white;
        font-size: 13px;
        margin-bottom: 8px;
      }

      .control-group input[type="range"] {
        width: 100%;
      }

      .control-group button {
        width: 100%;
        padding: 10px;
        background: linear-gradient(135deg, #ff6b9a, #ff3d7f);
        border: none;
        border-radius: 8px;
        color: white;
        font-weight: 600;
        cursor: pointer;
        font-size: 14px;
        transition: transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 4px 15px rgba(255, 107, 154, 0.4);
      }

      .control-group button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 107, 154, 0.6);
      }

      .control-group button:active {
        transform: translateY(0);
      }

      .image-list {
        font-size: 12px;
        color: #999;
        margin-top: 8px;
        max-height: 100px;
        overflow-y: auto;
      }

      .value-display {
        display: inline-block;
        color: #ff6b9a;
        font-weight: 600;
        margin-left: 8px;
      }

      .note {
        position: fixed;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        color: #999;
        font-size: 11px;
        text-align: center;
        text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
        max-width: 90%;
        padding: 0 10px;
        box-sizing: border-box;
      }
      
      /* Mobile responsiveness */
      @media (max-width: 600px) {
        .controls {
          top: 5px;
          right: 5px;
          padding: 8px;
          max-width: 95%;
          transform: translateX(calc(100% - 36px));
        }
        
        .controls h3 {
          font-size: 14px;
          margin-bottom: 8px;
        }
        
        .control-group {
          margin-bottom: 8px;
        }
        
        .control-group label {
          font-size: 11px;
        }
        
        .value-display {
          font-size: 11px;
        }
        
        .note {
          font-size: 10px;
          bottom: 5px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Audio element will be created by JavaScript -->
    <canvas class="fireworks-canvas" id="fireworks"></canvas>
    <div class="container" id="container"></div>

    <div class="controls">
      <h3>‚ú® Image Rain Controls</h3>

      <div class="control-group">
        <label>Add Image URLs (one per line):</label>
        <textarea
          id="imageUrls"
          rows="4"
          style="
            width: 100%;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 12px;
            font-family: monospace;
          "
        >
        </textarea>
        <div class="image-list" id="imageCount">8 images loaded</div>
      </div>

      <div class="control-group">
        <label
          >–≠—Ä–≥—ç–ª—Ç–∏–π–Ω —Ö—É—Ä–¥:
          <span class="value-display" id="rotationValue">1</span></label
        >
        <input
          type="range"
          id="rotationSpeed"
          min="0"
          max="20"
          value="1"
          step="1"
        />
      </div>

      <div class="control-group">
        <label
          >–°–∞–ª—é—Ç —Ö—É—Ä–¥:
          <span class="value-display" id="fireworkSpeedValue">1500</span
          >ms</label
        >
        <input
          type="range"
          id="fireworkSpeed"
          min="500"
          max="4000"
          value="1500"
          step="100"
        />
      </div>

      <div class="control-group">
        <label
          >–£–Ω–∞–ª—Ç—ã–Ω —Ö—É—Ä–¥:
          <span class="value-display" id="fallSpeedValue">7</span>s</label
        >
        <input
          type="range"
          id="fallSpeed"
          min="3"
          max="15"
          value="7"
          step="0.5"
        />
      </div>

      <div class="control-group">
        <label
          >“Æ—Ä–∂–ª–∏–π–Ω —Ö—É—Ä–¥:
          <span class="value-display" id="spawnRateValue">400</span>ms</label
        >
        <input
          type="range"
          id="spawnRate"
          min="300"
          max="2000"
          value="400"
          step="100"
        />
      </div>

      <div class="control-group">
        <button id="clearAll">–ë“Ø–≥–¥–∏–π–≥ –∞—Ä–∏–ª–≥–∞—Ö ‚ú®</button>
      </div>
      <div class="control-group">
        <button id="toggleControls" title="–ù—É—É—Ö" aria-label="–ù—É—É—Ö">–ù—É—É—Ö</button>
      </div>
    </div>

    <div class="note">üíó Images with words ‚Ä¢ Heart fireworks üíó</div>

    <button id="showControls" aria-hidden="true" title="–ö–æ–Ω—Ç—Ä–æ–ª—É—É–¥—ã–≥ —Ö–∞—Ä—É—É–ª–∞—Ö">
      –ö–æ–Ω—Ç—Ä–æ–ª—É—É–¥—ã–≥ —Ö–∞—Ä—É—É–ª–∞—Ö
    </button>

    <script>
      // Fireworks setup with heart shapes
      const fireworksCanvas = document.getElementById("fireworks");
      const fireworksCtx = fireworksCanvas.getContext("2d");
      fireworksCanvas.width = window.innerWidth;
      fireworksCanvas.height = window.innerHeight;

      window.addEventListener("resize", () => {
        fireworksCanvas.width = window.innerWidth;
        fireworksCanvas.height = window.innerHeight;
      });

      const fireworks = [];
      const particles = [];

      // Heart shape patterns
      function getHeartPattern(scale = 1) {
        const points = [];
        for (let t = 0; t < Math.PI * 2; t += 0.1) {
          const x = 16 * Math.pow(Math.sin(t), 3) * scale;
          const y =
            -(
              13 * Math.cos(t) -
              5 * Math.cos(2 * t) -
              2 * Math.cos(3 * t) -
              Math.cos(4 * t)
            ) * scale;
          points.push({ x, y });
        }
        return points;
      }

      // Star pattern
      function getStarPattern(scale = 1) {
        const points = [];
        const spikes = 5;
        for (let i = 0; i < spikes * 2; i++) {
          const angle = (i * Math.PI) / spikes;
          const radius = i % 2 === 0 ? 20 * scale : 10 * scale;
          points.push({
            x: Math.cos(angle) * radius,
            y: Math.sin(angle) * radius,
          });
        }
        return points;
      }

      // Circle burst
      function getCirclePattern(scale = 1) {
        const points = [];
        for (let i = 0; i < 60; i++) {
          const angle = (i * Math.PI * 2) / 60;
          points.push({
            x: Math.cos(angle) * 15 * scale,
            y: Math.sin(angle) * 15 * scale,
          });
        }
        return points;
      }

      // Spiral pattern
      function getSpiralPattern(scale = 1) {
        const points = [];
        for (let i = 0; i < 50; i++) {
          const angle = (i * Math.PI) / 8;
          const radius = i * 0.5 * scale;
          points.push({
            x: Math.cos(angle) * radius,
            y: Math.sin(angle) * radius,
          });
        }
        return points;
      }

      // Ring pattern
      function getRingPattern(scale = 1) {
        const points = [];
        const rings = 3;
        for (let r = 0; r < rings; r++) {
          const radius = (r + 1) * 8 * scale;
          const count = 20 + r * 10;
          for (let i = 0; i < count; i++) {
            const angle = (i * Math.PI * 2) / count;
            points.push({
              x: Math.cos(angle) * radius,
              y: Math.sin(angle) * radius,
            });
          }
        }
        return points;
      }

      const patterns = [
        getHeartPattern,
        getStarPattern,
        getCirclePattern,
        getSpiralPattern,
        getRingPattern,
      ];

      class Firework {
        constructor() {
          this.x = Math.random() * fireworksCanvas.width;
          this.y = fireworksCanvas.height;
          this.targetY = Math.random() * fireworksCanvas.height * 0.4 + 50;
          this.speed = Math.random() * 3 + 3;
          this.color = `hsl(${Math.random() * 360}, 100%, 65%)`;
          this.trail = [];
        }

        update() {
          this.trail.push({ x: this.x, y: this.y });
          if (this.trail.length > 10) this.trail.shift();
          this.y -= this.speed;
          return this.y <= this.targetY;
        }

        draw() {
          fireworksCtx.save();
          for (let i = 0; i < this.trail.length; i++) {
            const t = this.trail[i];
            fireworksCtx.globalAlpha = i / this.trail.length;
            fireworksCtx.fillStyle = this.color;
            fireworksCtx.beginPath();
            fireworksCtx.arc(t.x, t.y, 2, 0, Math.PI * 2);
            fireworksCtx.fill();
          }
          fireworksCtx.restore();

          fireworksCtx.fillStyle = this.color;
          fireworksCtx.beginPath();
          fireworksCtx.arc(this.x, this.y, 3, 0, Math.PI * 2);
          fireworksCtx.fill();
        }
      }

      class Particle {
        constructor(x, y, color, vx, vy) {
          this.x = x;
          this.y = y;
          this.color = color;
          this.vx = vx;
          this.vy = vy;
          this.life = 1;
          this.decay = Math.random() * 0.015 + 0.01;
          this.size = Math.random() * 3 + 1.5;
          this.gravity = 0.08;
        }

        update() {
          this.vx *= 0.97;
          this.vy *= 0.97;
          this.vy += this.gravity;
          this.x += this.vx;
          this.y += this.vy;
          this.life -= this.decay;
          return this.life > 0;
        }

        draw() {
          fireworksCtx.save();
          fireworksCtx.globalAlpha = this.life;
          fireworksCtx.fillStyle = this.color;
          fireworksCtx.shadowBlur = 10;
          fireworksCtx.shadowColor = this.color;
          fireworksCtx.beginPath();
          fireworksCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
          fireworksCtx.fill();
          fireworksCtx.restore();
        }
      }

      function explode(x, y, color) {
        // Random pattern selection
        const patternFunc =
          patterns[Math.floor(Math.random() * patterns.length)];
        const scale = Math.random() * 0.8 + 0.8;
        const pattern = patternFunc(scale);

        // Create particles along the pattern
        pattern.forEach((point) => {
          const speed = Math.random() * 2 + 2;
          const vx = (point.x / 15) * speed;
          const vy = (point.y / 15) * speed;
          particles.push(new Particle(x, y, color, vx, vy));
        });

        // Add some random sparkles
        for (let i = 0; i < 30; i++) {
          const angle = Math.random() * Math.PI * 2;
          const speed = Math.random() * 4 + 1;
          const vx = Math.cos(angle) * speed;
          const vy = Math.sin(angle) * speed;
          particles.push(new Particle(x, y, color, vx, vy));
        }
      }

      function animateFireworks() {
        fireworksCtx.fillStyle = "rgba(10, 0, 21, 0.15)";
        fireworksCtx.fillRect(
          0,
          0,
          fireworksCanvas.width,
          fireworksCanvas.height
        );

        for (let i = fireworks.length - 1; i >= 0; i--) {
          const fw = fireworks[i];
          const exploded = fw.update();
          fw.draw();

          if (exploded) {
            explode(fw.x, fw.y, fw.color);
            fireworks.splice(i, 1);
          }
        }

        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          const alive = p.update();
          p.draw();

          if (!alive) {
            particles.splice(i, 1);
          }
        }

        requestAnimationFrame(animateFireworks);
      }

      let fireworkInterval;
      function startFireworks(interval = 1500) {
        if (fireworkInterval) clearInterval(fireworkInterval);
        fireworkInterval = setInterval(() => {
          fireworks.push(new Firework());
        }, interval);
      }

      animateFireworks();
      startFireworks();

      // Initialize background music
      const backgroundMusic = new Audio(
        "haroinfather-princess-bubblegum-official-music-video_brsUx40v.mp3"
      );
      backgroundMusic.loop = true;
      backgroundMusic.volume = 0.5; // 50% volume

      // Set up audio context for mobile devices
      let audioContext;

      // Function to handle audio playback
      const playAudio = () => {
        // Resume audio context if it exists
        if (audioContext && audioContext.state === "suspended") {
          audioContext.resume();
        }

        // Try to play the audio
        const playPromise = backgroundMusic.play();

        if (playPromise !== undefined) {
          playPromise
            .then(() => {
              console.log("Audio playing successfully");
              // Remove any existing touch listeners
              document.removeEventListener("touchstart", handleFirstTouch);
              document.removeEventListener("touchend", handleFirstTouch);
            })
            .catch((error) => {
              console.log("Autoplay prevented:", error);
            });
        }
      };

      // Handle first touch interaction (for mobile)
      const handleFirstTouch = (e) => {
        // Create audio context on first touch if it doesn't exist
        if (!audioContext) {
          audioContext = new (window.AudioContext ||
            window.webkitAudioContext)();
        }

        // Try to play audio
        playAudio();

        // Remove this event listener after first touch
        document.removeEventListener("touchstart", handleFirstTouch);
        document.removeEventListener("touchend", handleFirstTouch);
      };

      // Set up touch and click listeners for audio
      document.addEventListener("touchstart", handleFirstTouch, { once: true });
      document.addEventListener("touchend", handleFirstTouch, { once: true });
      document.addEventListener("click", playAudio, { once: true });

      // Try to play immediately
      playAudio();

      // Also try when the page becomes visible (for mobile)
      document.addEventListener("visibilitychange", () => {
        if (document.visibilityState === "visible") {
          playAudio();
        }
      });

      // Main falling images script
      const container = document.getElementById("container");
      const imageUrlsInput = document.getElementById("imageUrls");
      const rotationSpeedInput = document.getElementById("rotationSpeed");
      const fallSpeedInput = document.getElementById("fallSpeed");
      const spawnRateInput = document.getElementById("spawnRate");
      const fireworkSpeedInput = document.getElementById("fireworkSpeed");
      const clearAllBtn = document.getElementById("clearAll");
      //
      // const words = [
      //   "Javzaaüíó",
      //   "wookiey dookiey‚ú®",
      //   "bunnyüê∞",
      //   "gunjüë∏",
      //   "wookieyüíó",
      //   "dookieyüíó",
      //   "cutie",
      //   "sweetie",
      // Get URL parameters
      const urlParams = new URLSearchParams(window.location.search);
      const wordSet = urlParams.get("word_set") || "default";

      // Default words and images
      const wordSets = {
        teacher: [
          "Mundag shuu egee",
          "Happy pepero  dayyy ^~^",
          "üíì",
          "Bi tanii fan shuu :3",
          "Setgeltei",
          "Erch huchtei",
          "Vibe niildeg",
          "Gal togoonii party hamtragch",
          "Huurhun",
          "Forrr oyukaaaa",
        ],
        default: [
          "–ú–∏–Ω–∏–π —Ö–∞–π—Ä—Ç –º–æ–Ω–≥–æ–ª —Ö—ç–ª–Ω–∏–π –±–∞–≥—à. üë©‚Äçüè´",
          "–ù–∞—Ä–∞–Ω –≥—ç—Ä—ç–ª—Ç—Å—ç–Ω –±–∞–≥—à –º–∏–Ω—å",
          "–°—ç—Ç–≥—ç–ª –≥—ç–∂ —á–∏–∫–∞",
          "–ì–æ—ë —Ö–æ–æ–ª —Ö–∏–π–¥—ç–≥",
          "–ì—ç—Ä–∏–π–Ω –±—É–≥",
          "üë©‚Äçüç≥",
          "üíì",
          "Happy pepero  dayyy üòä",
          "Bi bas tanii fan shuu :3",
          "–ì–æ–π–º–æ–Ω –±–∞–≥–∞ –∏–¥—ç—ç—Ä—ç–π",
          "–ë–∞–≥–∞ –≥–∞–∞–∑—Ç–∞–π —É–Ω–¥–∞–∞ —É—É–≥–∞–∞—Ä–∞–π ü•§",
          "Happy pepero  dayyy ^~^",
        ],
        class: [
          "Mundag shuu egee",
          "Happy pepero  dayyy ^~^",
          "üíì",
          "Bi tanii fan shuu :3",
          "Setgeltei",
          "Erch huchtei",
          "Vibe niildeg",
          "Gal togoonii party hamtragch",
          "Huurhun",
          "Forrr oyukaaaa",
        ],
        // Add more word sets here as needed
      };

      // Use the specified word set or default
      const words = wordSets[wordSet] || wordSets.default;

      // Default image sets
      const imageSets = {
        teacher: [
          "https://scontent.fuln8-1.fna.fbcdn.net/v/t1.15752-9/582060542_1347344193751859_4816782136432802783_n.png?_nc_cat=105&ccb=1-7&_nc_sid=0024fc&_nc_ohc=Dl7t0uxpylEQ7kNvwERF13l&_nc_oc=AdlGh5Q3cV7ceGlXyemRY5pLtBGuFWhzHes0Plo8NcRu7KVks49p28_FQ8tajKBce-8&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln8-1.fna&oh=03_Q7cD3wELNAoEMTMnalst-FqNABbRnJEpscVa6_jsh8oKfgWqvQ&oe=693A0B48",

          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/552522860_1138813744876947_376985843192678651_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=0024fc&_nc_ohc=6aAlUCr8bDMQ7kNvwGse7K1&_nc_oc=AdniHTIv_GLg6lgQC_PUChBIftZR8jJdFDaEOEG5LE4Bj4H-kC7C5_Pt_tfxqD7a7So&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wF9pya2_fJfROnYvdk6E2CauWMqKcsQIHlORJLIHcTbHQ&oe=69396166",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/518884541_1239525974539377_3817574779921933855_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=108&ccb=1-7&_nc_sid=0024fc&_nc_ohc=wvqzhlodNZEQ7kNvwFe-hA6&_nc_oc=AdkFJlnNrOztNzIchWhA60qJ2ItpBuI47PdBTY3UbJMNi-hox-vu2VqBYdtpjAIVEC0&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wEi3j-E5me_yrUKZZL8eAAqoBqUyKNHP3sCO2DD1GInwg&oe=69398C94",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/504967159_1387500282469830_109339219580623394_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=100&ccb=1-7&_nc_sid=0024fc&_nc_ohc=F4lsiW3FKboQ7kNvwGmL1Jz&_nc_oc=Adkyrf2_lHMyaB05M651PXJOgAC88U2i2G0oXZWMRSgando6KyLqXUSSJ-jT5SryCPM&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wHBDtBITZhq04o1ykLngxtvSJJjO-VKo4uxe2H7r0AvLQ&oe=69398B70",
          "https://scontent.fuln4-3.fna.fbcdn.net/v/t1.15752-9/494689012_717067664207886_3890005613961274618_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=111&ccb=1-7&_nc_sid=0024fc&_nc_ohc=kPqmSjsqFBMQ7kNvwEzBKJx&_nc_oc=AdmyNKtMtgceeUDBrRuxH8F0IDWX2Sc0e5oAufAFblH_wdAyFM5tgja54soB08HZ22o&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-3.fna&oh=03_Q7cD3wFAq_hoGVDpvQa9_C_NDA1JeWR4wNNFakWcYGUlQIRTzg&oe=69396B0E",
          "https://munchaddict.com/cdn/shop/files/LottePeperoStrawberry_Korea_1500x.jpg?v=1720033850",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/581860393_1371828761214635_1540297993231848753_n.png?stp=dst-png_p2048x2048&_nc_cat=105&ccb=1-7&_nc_sid=0024fc&_nc_ohc=w3WHAALGhc0Q7kNvwHLzcj-&_nc_oc=Adl1RcCTwBj1ie9BeB9o6z9telXD7pCIDsqEF3COGyF-M36sxJuPJLdNxIzYknXsi70&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wFafxE9ymp_kLjwEemZN2hiE-mzw7ZYpOGj-AJQwFazSQ&oe=693980D6",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/581860393_1371828761214635_1540297993231848753_n.png?stp=dst-png_s640x640&_nc_cat=105&ccb=1-7&_nc_sid=0024fc&_nc_ohc=w3WHAALGhc0Q7kNvwHLzcj-&_nc_oc=Adl1RcCTwBj1ie9BeB9o6z9telXD7pCIDsqEF3COGyF-M36sxJuPJLdNxIzYknXsi70&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wHXaH0Rt4B_N9X1b8BhyuWSy6Dw5IonAHZtdt-wyUgA3A&oe=693980D6",
          "https://scontent.fuln4-3.fna.fbcdn.net/v/t1.15752-9/578001572_733265075717627_2972317702001717590_n.png?_nc_cat=111&ccb=1-7&_nc_sid=0024fc&_nc_ohc=cMLI24R8RnsQ7kNvwH3EpWP&_nc_oc=AdmSjxQhY9exaocJ3KZ6INdiHE6OhioypMAqeXxtE-hr9t-1xRXd7DjysaZZBtk0v8c&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-3.fna&oh=03_Q7cD3wFLhP3O-yDZyXrW1fgoErGEJf66-E4kebzlQoh8TXATUw&oe=69396B91",
          "https://scontent.fuln8-1.fna.fbcdn.net/v/t1.15752-9/581847837_1341270991118465_8407225106639221851_n.png?stp=dst-png_s480x480&_nc_cat=111&ccb=1-7&_nc_sid=0024fc&_nc_ohc=9ULltCl39PIQ7kNvwF2SI4S&_nc_oc=Adl1hQPh-Vg1tF_0RfVEDhB83FlS9RjQDRF15lMiR3t34ZQGWaogbBMgDI38J6yqgzo&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln8-1.fna&oh=03_Q7cD3wFupYmJEx5WYCQ27E8yCYVb3U5qCZW9pSlK5DFkOKCFAA&oe=693A28FD",
        ],
        default: [
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/552522860_1138813744876947_376985843192678651_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=0024fc&_nc_ohc=6aAlUCr8bDMQ7kNvwGse7K1&_nc_oc=AdniHTIv_GLg6lgQC_PUChBIftZR8jJdFDaEOEG5LE4Bj4H-kC7C5_Pt_tfxqD7a7So&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wF9pya2_fJfROnYvdk6E2CauWMqKcsQIHlORJLIHcTbHQ&oe=69396166",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/518884541_1239525974539377_3817574779921933855_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=108&ccb=1-7&_nc_sid=0024fc&_nc_ohc=wvqzhlodNZEQ7kNvwFe-hA6&_nc_oc=AdkFJlnNrOztNzIchWhA60qJ2ItpBuI47PdBTY3UbJMNi-hox-vu2VqBYdtpjAIVEC0&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wEi3j-E5me_yrUKZZL8eAAqoBqUyKNHP3sCO2DD1GInwg&oe=69398C94",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/504967159_1387500282469830_109339219580623394_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=100&ccb=1-7&_nc_sid=0024fc&_nc_ohc=F4lsiW3FKboQ7kNvwGmL1Jz&_nc_oc=Adkyrf2_lHMyaB05M651PXJOgAC88U2i2G0oXZWMRSgando6KyLqXUSSJ-jT5SryCPM&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wHBDtBITZhq04o1ykLngxtvSJJjO-VKo4uxe2H7r0AvLQ&oe=69398B70",
          "https://scontent.fuln4-3.fna.fbcdn.net/v/t1.15752-9/494689012_717067664207886_3890005613961274618_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=111&ccb=1-7&_nc_sid=0024fc&_nc_ohc=kPqmSjsqFBMQ7kNvwEzBKJx&_nc_oc=AdmyNKtMtgceeUDBrRuxH8F0IDWX2Sc0e5oAufAFblH_wdAyFM5tgja54soB08HZ22o&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-3.fna&oh=03_Q7cD3wFAq_hoGVDpvQa9_C_NDA1JeWR4wNNFakWcYGUlQIRTzg&oe=69396B0E",
          "https://munchaddict.com/cdn/shop/files/LottePeperoStrawberry_Korea_1500x.jpg?v=1720033850",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/581860393_1371828761214635_1540297993231848753_n.png?stp=dst-png_p2048x2048&_nc_cat=105&ccb=1-7&_nc_sid=0024fc&_nc_ohc=w3WHAALGhc0Q7kNvwHLzcj-&_nc_oc=Adl1RcCTwBj1ie9BeB9o6z9telXD7pCIDsqEF3COGyF-M36sxJuPJLdNxIzYknXsi70&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wFafxE9ymp_kLjwEemZN2hiE-mzw7ZYpOGj-AJQwFazSQ&oe=693980D6",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/581860393_1371828761214635_1540297993231848753_n.png?stp=dst-png_s640x640&_nc_cat=105&ccb=1-7&_nc_sid=0024fc&_nc_ohc=w3WHAALGhc0Q7kNvwHLzcj-&_nc_oc=Adl1RcCTwBj1ie9BeB9o6z9telXD7pCIDsqEF3COGyF-M36sxJuPJLdNxIzYknXsi70&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wHXaH0Rt4B_N9X1b8BhyuWSy6Dw5IonAHZtdt-wyUgA3A&oe=693980D6",
          "https://scontent.fuln8-1.fna.fbcdn.net/v/t1.15752-9/581847837_1341270991118465_8407225106639221851_n.png?stp=dst-png_s480x480&_nc_cat=111&ccb=1-7&_nc_sid=0024fc&_nc_ohc=9ULltCl39PIQ7kNvwF2SI4S&_nc_oc=Adl1hQPh-Vg1tF_0RfVEDhB83FlS9RjQDRF15lMiR3t34ZQGWaogbBMgDI38J6yqgzo&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln8-1.fna&oh=03_Q7cD3wFupYmJEx5WYCQ27E8yCYVb3U5qCZW9pSlK5DFkOKCFAA&oe=693A28FD",

          "https://scontent.fuln10-1.fna.fbcdn.net/v/t1.15752-9/579661158_1180528987351769_4086371376230490656_n.png?_nc_cat=103&ccb=1-7&_nc_sid=0024fc&_nc_ohc=Osj_GIy8xhYQ7kNvwEgXBoL&_nc_oc=Adm8RzZdye51qLozAXjKFRyIY875TIpx_x1KNYeVjfDcuP6dT41NSIbWj30R0bUX6jY&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln10-1.fna&oh=03_Q7cD3wGmXtf94Qd2Ew4LWSuCG-Mxd-7yjQYaAaAbdE_a6hEwXA&oe=69398E85",
          "https://scontent.fuln10-1.fna.fbcdn.net/v/t1.15752-9/582013843_4253837981554155_2134258397944142302_n.png?_nc_cat=105&ccb=1-7&_nc_sid=0024fc&_nc_ohc=Kx5wAJXY_McQ7kNvwESJHlL&_nc_oc=AdmZ8UdRmYT7dWsea75Sx6eGbOksfetDsT-sUZmKSnYpa0xU9h0p-7-Yxt5oS27_m_0&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln10-1.fna&oh=03_Q7cD3wGH-jb0Ah3evmVyFrHUKAX2w2tLlez-OqKzbwowoYVBAA&oe=69398594",
          "https://scontent.fuln10-1.fna.fbcdn.net/v/t1.15752-9/577825630_756642684114367_7726348462160122974_n.png?_nc_cat=101&ccb=1-7&_nc_sid=0024fc&_nc_ohc=tGwx2IhRu1sQ7kNvwFDtHib&_nc_oc=AdlqQf7F4MmhwrIL--wn751Vbhj09dI7_3sGjyMlog-Ewpo4CBYzD9g1A7eB6rFCpT0&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln10-1.fna&oh=03_Q7cD3wES_i1FkrC_oA6RpCJaDblQQe9KOn7oFoNal4YSOOdrZw&oe=69396381",
        ],
        class: [
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/552522860_1138813744876947_376985843192678651_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=0024fc&_nc_ohc=6aAlUCr8bDMQ7kNvwGse7K1&_nc_oc=AdniHTIv_GLg6lgQC_PUChBIftZR8jJdFDaEOEG5LE4Bj4H-kC7C5_Pt_tfxqD7a7So&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wF9pya2_fJfROnYvdk6E2CauWMqKcsQIHlORJLIHcTbHQ&oe=69396166",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/518884541_1239525974539377_3817574779921933855_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=108&ccb=1-7&_nc_sid=0024fc&_nc_ohc=wvqzhlodNZEQ7kNvwFe-hA6&_nc_oc=AdkFJlnNrOztNzIchWhA60qJ2ItpBuI47PdBTY3UbJMNi-hox-vu2VqBYdtpjAIVEC0&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wEi3j-E5me_yrUKZZL8eAAqoBqUyKNHP3sCO2DD1GInwg&oe=69398C94",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/504967159_1387500282469830_109339219580623394_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=100&ccb=1-7&_nc_sid=0024fc&_nc_ohc=F4lsiW3FKboQ7kNvwGmL1Jz&_nc_oc=Adkyrf2_lHMyaB05M651PXJOgAC88U2i2G0oXZWMRSgando6KyLqXUSSJ-jT5SryCPM&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wHBDtBITZhq04o1ykLngxtvSJJjO-VKo4uxe2H7r0AvLQ&oe=69398B70",
          "https://scontent.fuln4-3.fna.fbcdn.net/v/t1.15752-9/494689012_717067664207886_3890005613961274618_n.jpg?stp=dst-jpg_s480x480_tt6&_nc_cat=111&ccb=1-7&_nc_sid=0024fc&_nc_ohc=kPqmSjsqFBMQ7kNvwEzBKJx&_nc_oc=AdmyNKtMtgceeUDBrRuxH8F0IDWX2Sc0e5oAufAFblH_wdAyFM5tgja54soB08HZ22o&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-3.fna&oh=03_Q7cD3wFAq_hoGVDpvQa9_C_NDA1JeWR4wNNFakWcYGUlQIRTzg&oe=69396B0E",
          "https://munchaddict.com/cdn/shop/files/LottePeperoStrawberry_Korea_1500x.jpg?v=1720033850",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/581860393_1371828761214635_1540297993231848753_n.png?stp=dst-png_p2048x2048&_nc_cat=105&ccb=1-7&_nc_sid=0024fc&_nc_ohc=w3WHAALGhc0Q7kNvwHLzcj-&_nc_oc=Adl1RcCTwBj1ie9BeB9o6z9telXD7pCIDsqEF3COGyF-M36sxJuPJLdNxIzYknXsi70&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wFafxE9ymp_kLjwEemZN2hiE-mzw7ZYpOGj-AJQwFazSQ&oe=693980D6",
          "https://scontent.fuln4-2.fna.fbcdn.net/v/t1.15752-9/581860393_1371828761214635_1540297993231848753_n.png?stp=dst-png_s640x640&_nc_cat=105&ccb=1-7&_nc_sid=0024fc&_nc_ohc=w3WHAALGhc0Q7kNvwHLzcj-&_nc_oc=Adl1RcCTwBj1ie9BeB9o6z9telXD7pCIDsqEF3COGyF-M36sxJuPJLdNxIzYknXsi70&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln4-2.fna&oh=03_Q7cD3wHXaH0Rt4B_N9X1b8BhyuWSy6Dw5IonAHZtdt-wyUgA3A&oe=693980D6",
          "https://scontent.fuln8-1.fna.fbcdn.net/v/t1.15752-9/581847837_1341270991118465_8407225106639221851_n.png?stp=dst-png_s480x480&_nc_cat=111&ccb=1-7&_nc_sid=0024fc&_nc_ohc=9ULltCl39PIQ7kNvwF2SI4S&_nc_oc=Adl1hQPh-Vg1tF_0RfVEDhB83FlS9RjQDRF15lMiR3t34ZQGWaogbBMgDI38J6yqgzo&_nc_ad=z-m&_nc_cid=0&_nc_zt=23&_nc_ht=scontent.fuln8-1.fna&oh=03_Q7cD3wFupYmJEx5WYCQ27E8yCYVb3U5qCZW9pSlK5DFkOKCFAA&oe=693A28FD",
        ],
        // Add more image sets here as needed
      };

      // Get image set from URL or use default
      const imageSet = urlParams.get("image_set") || "default";
      let imageUrls = imageSets[imageSet] || imageSets.default;

      let rotationSpeed = 0;
      let fallSpeed = 7;
      let spawnInterval;

      function updateImageUrls() {
        const text = imageUrlsInput.value.trim();
        const customUrls = text
          .split("\n")
          .filter((url) => url.trim().length > 0);

        // If there are custom URLs in the textarea, use those
        // Otherwise, use the default set based on URL parameter
        if (customUrls.length > 0) {
          imageUrls = customUrls;
        } else {
          const imageSet = urlParams.get("image_set") || "default";
          imageUrls = imageSets[imageSet] || imageSets.default;
        }

        document.getElementById("imageCount").textContent = `${
          imageUrls.length
        } image${imageUrls.length !== 1 ? "s" : ""} loaded`;

        // Update URL with current settings
        const newUrl = new URL(window.location);
        if (imageUrls.length > 0) {
          newUrl.searchParams.set("images", imageUrls.length);
        } else {
          newUrl.searchParams.delete("images");
        }
        window.history.replaceState({}, "", newUrl);
      }

      function rand(min, max) {
        return Math.random() * (max - min) + min;
      }

      function createFallingItem() {
        const item = document.createElement("div");
        item.className = "falling-item";

        const isImage = imageUrls.length > 0 && Math.random() < 0.6;
        const size = isImage ? rand(60, 120) : rand(24, 48);

        item.style.width = size + "px";
        item.style.height = size + "px";
        item.style.left = rand(0, window.innerWidth - size) + "px";
        item.style.top = "-" + (size + 20) + "px";

        if (isImage) {
          const img = document.createElement("img");
          const url = imageUrls[Math.floor(Math.random() * imageUrls.length)];
          img.src = url;
          img.alt = "falling";
          img.onerror = function () {
            item.innerHTML = '<div class="falling-text">üíó</div>';
          };
          item.appendChild(img);
        } else {
          const text = document.createElement("div");
          text.className = "falling-text color-" + Math.floor(rand(1, 6));
          text.textContent = words[Math.floor(Math.random() * words.length)];
          text.style.fontSize = size + "px";
          item.appendChild(text);
        }

        container.appendChild(item);

        const duration = fallSpeed * 1000;
        const rotation = rand(-360 * rotationSpeed, 360 * rotationSpeed);
        const xDrift = rand(-100, 100);

        const animation = item.animate(
          [
            {
              transform: `translate(0, 0) rotate(0deg)`,
              opacity: 0,
            },
            {
              transform: `translate(${xDrift * 0.3}px, ${
                window.innerHeight * 0.3
              }px) rotate(${rotation * 0.3}deg)`,
              opacity: 1,
              offset: 0.1,
            },
            {
              transform: `translate(${xDrift * 0.6}px, ${
                window.innerHeight * 0.6
              }px) rotate(${rotation * 0.6}deg)`,
              opacity: 1,
              offset: 0.5,
            },
            {
              transform: `translate(${xDrift}px, ${
                window.innerHeight + 100
              }px) rotate(${rotation}deg)`,
              opacity: 0,
            },
          ],
          {
            duration: duration,
            easing: "cubic-bezier(0.25, 0.46, 0.45, 0.94)",
            fill: "forwards",
          }
        );

        animation.onfinish = () => item.remove();
      }

      function startSpawning() {
        if (spawnInterval) clearInterval(spawnInterval);
        spawnInterval = setInterval(
          createFallingItem,
          parseInt(spawnRateInput.value)
        );
      }

      // Update displays and values
      rotationSpeedInput.addEventListener("input", (e) => {
        rotationSpeed = parseInt(e.target.value);
        document.getElementById("rotationValue").textContent = rotationSpeed;
      });

      fallSpeedInput.addEventListener("input", (e) => {
        fallSpeed = parseFloat(e.target.value);
        document.getElementById("fallSpeedValue").textContent = fallSpeed + "s";
      });

      spawnRateInput.addEventListener("input", (e) => {
        document.getElementById("spawnRateValue").textContent =
          e.target.value + "ms";
        startSpawning();
      });

      fireworkSpeedInput.addEventListener("input", (e) => {
        document.getElementById("fireworkSpeedValue").textContent =
          e.target.value + "ms";
        startFireworks(parseInt(e.target.value));
      });

      imageUrlsInput.addEventListener("input", updateImageUrls);

      clearAllBtn.addEventListener("click", () => {
        container.innerHTML = "";
      });

      // Initialize
      updateImageUrls();

      // Set default spawn rate depending on device
      (function () {
        const isMobile =
          /Mobi|Android|iP(ad|hone|od)|IEMobile|Opera Mini/i.test(
            navigator.userAgent
          ) ||
          (window.matchMedia && window.matchMedia("(pointer:coarse)").matches);
        const defaultSpawn = isMobile ? 800 : 400;
        spawnRateInput.value = defaultSpawn;
        document.getElementById("spawnRateValue").textContent =
          defaultSpawn + "ms";
      })();

      startSpawning();

      // Create initial items with touch support
      const createInitialItems = () => {
        const count = isMobile ? 20 : 25; // Fewer items on mobile for better performance
        for (let i = 0; i < count; i++) {
          setTimeout(createFallingItem, i * 200);
        }
      };

      // Load image set based on URL parameter or default to teacher's set
      const selectedImageSetName = urlParams.get("word_set") || "teacher";
      const selectedImageSet =
        imageSets[selectedImageSetName] || imageSets.default;
      imageUrlsInput.value = selectedImageSet.join("\n");
      updateImageUrls();

      // Start with initial items
      createInitialItems();

      // Add touch event for mobile to create items on tap
      let lastTap = 0;
      container.addEventListener("touchend", (e) => {
        const currentTime = new Date().getTime();
        const tapLength = currentTime - lastTap;
        if (tapLength < 300 && tapLength > 0) {
          // Double tap detected - create a few more items
          for (let i = 0; i < 3; i++) {
            createFallingItem();
          }
        }
        lastTap = currentTime;
      });

      // Collapsible controls
      (function () {
        const controls = document.querySelector(".controls");
        const toggleBtn = document.getElementById("toggleControls");
        const showBtn = document.getElementById("showControls");

        if (!controls || !toggleBtn || !showBtn) return;

        // Hide controls by default
        controls.classList.remove("visible");

        function showControls() {
          controls.classList.add("visible");
          toggleBtn.setAttribute("aria-expanded", "true");
          showBtn.setAttribute("aria-hidden", "true");
        }

        function hideControls() {
          controls.classList.remove("visible");
          toggleBtn.setAttribute("aria-expanded", "false");
          showBtn.setAttribute("aria-hidden", "false");
        }

        function showControls() {
          controls.classList.remove("hidden");
          toggleBtn.setAttribute("aria-expanded", "true");
          showBtn.setAttribute("aria-hidden", "true");
        }

        toggleBtn.addEventListener("click", () => {
          if (!controls.classList.contains("visible")) showControls();
          else hideControls();
        });

        // Show controls button
        showBtn.style.display = "block";
        showBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          showControls();
        });

        showBtn.addEventListener("click", showControls);

        document.addEventListener("keydown", (e) => {
          const tag = document.activeElement && document.activeElement.tagName;
          if (tag === "INPUT" || tag === "TEXTAREA" || tag === "SELECT") return;
          if (e.key && e.key.toLowerCase() === "c") {
            if (controls.classList.contains("hidden")) showControls();
            else hideControls();
          }
        });
      })();
    </script>
  </body>
</html>
